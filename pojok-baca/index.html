<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pojok Baca - Rumah Baca Ulil Albab</title>
  <meta name="description" content="Jelajahi koleksi buku digital Pojok Baca Ulil Albab. Baca langsung, simpan untuk nanti, atau ajukan unggah buku baru">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  
  <!-- AOS Animation -->
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
  
  <style>
    :root {
      --primary-green: #15803d;
      --primary-orange: #f97316;
      --light-green: #dcfce7;
      --light-orange: #ffedd5;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #fafafa;
    }
    
    .gradient-text {
      background: linear-gradient(135deg, var(--primary-green), var(--primary-orange));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .card {
      background: white;
      border-radius: 1rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
      transition: all 0.3s ease;
      overflow: hidden;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
    }
    
    .btn-primary {
      background: var(--primary-green);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 0.75rem;
      font-weight: 500;
      transition: all 0.2s ease;
    }
    
    .btn-primary:hover {
      background: #166534;
      transform: translateY(-2px);
    }
    
    .btn-secondary {
      background: white;
      color: var(--primary-green);
      border: 1.5px solid var(--primary-green);
      padding: 0.75rem 1.5rem;
      border-radius: 0.75rem;
      font-weight: 500;
      transition: all 0.2s ease;
    }
    
    .btn-secondary:hover {
      background: var(--light-green);
      transform: translateY(-2px);
    }
    
    .input-field {
      width: 100%;
      border: 1.5px solid #e5e7eb;
      border-radius: 0.75rem;
      padding: 0.75rem 1rem;
      font-size: 0.95rem;
      transition: all 0.2s ease;
    }
    
    .input-field:focus {
      border-color: var(--primary-orange);
      box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.15);
      outline: none;
    }
    
    .select-field {
      width: 100%;
      border: 1.5px solid #e5e7eb;
      border-radius: 0.75rem;
      padding: 0.75rem 1rem;
      font-size: 0.95rem;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 1rem;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      transition: all 0.2s ease;
    }
    
    .select-field:focus {
      border-color: var(--primary-orange);
      box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.15);
      outline: none;
    }
    
    .book-cover {
      transition: transform 0.3s ease;
    }
    
    .book-card:hover .book-cover {
      transform: scale(1.05);
    }
    
    .category-badge {
      display: inline-block;
      padding: 0.35rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 500;
      background: var(--light-green);
      color: var(--primary-green);
    }
    
    .loading-spinner {
      width: 2rem;
      height: 2rem;
      border: 2px solid #e5e7eb;
      border-top: 2px solid var(--primary-green);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: var(--primary-green);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 0.75rem;
      box-shadow: 0 10px 25px rgba(21, 128, 61, 0.3);
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #c5c5c5;
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary-orange);
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

<div id="navbar"></div>

  <!-- HERO SECTION -->
  <section class="pt-24 pb-12 bg-gradient-to-b from-white to-emerald-50">
    <div class="container mx-auto px-4 md:px-6">
      <div class="flex flex-col md:flex-row items-center gap-8 md:gap-12">
        <div class="w-full md:w-1/2" data-aos="fade-right">
          <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold leading-tight mb-4">
            <span class="gradient-text">Pojok Baca</span> Digital<br>Rumah Baca Ulil Albab
          </h1>
          <p class="text-lg text-gray-600 mb-6">
            Jelajahi koleksi buku digital kami, baca langsung, simpan untuk nanti, atau ajukan unggah buku baru melalui proses kurasi.
          </p>
          <div class="flex flex-col sm:flex-row gap-4">
            <button id="uploadBtn" class="btn-secondary inline-flex items-center justify-center gap-2">
              <i class="bi bi-cloud-upload"></i> Unggah Buku
            </button>
            <a href="#koleksi" class="btn-primary inline-flex items-center justify-center gap-2">
              <i class="bi bi-book"></i> Jelajahi Koleksi
            </a>
          </div>
        </div>
        <div class="w-full md:w-1/2" data-aos="fade-left">
          <div class="card p-6">
            <div class="bg-gradient-to-br from-green-100 to-orange-100 rounded-xl p-6 h-72 flex flex-col items-center justify-center">
              <i class="bi bi-journal-bookmark text-6xl text-green-600 mb-4"></i>
              <p class="text-center text-green-700 font-medium">Temukan pengetahuan tanpa batas di Pojok Baca digital kami</p>
            </div>
            <div class="mt-4 flex items-center justify-center gap-4">
              <div class="text-center">
                <div class="text-2xl font-bold text-green-700">50+</div>
                <div class="text-sm text-gray-600">Judul Buku</div>
              </div>
              <div class="h-8 w-px bg-gray-300"></div>
              <div class="text-center">
                <div class="text-2xl font-bold text-orange-600">5</div>
                <div class="text-sm text-gray-600">Kategori</div>
              </div>
              <div class="h-8 w-px bg-gray-300"></div>
              <div class="text-center">
                <div class="text-2xl font-bold text-green-700">100+</div>
                <div class="text-sm text-gray-600">Pembaca</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FILTER SECTION -->
  <section class="py-8 bg-white">
    <div class="container mx-auto px-4 md:px-6">
      <div class="card p-6" data-aos="fade-up">
        <div class="flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between">
          <h2 class="text-xl font-semibold text-gray-800">Filter Koleksi Buku</h2>
          
          <div class="flex flex-col sm:flex-row gap-4 w-full lg:w-auto">
            <div class="relative flex-1">
              <i class="bi bi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input id="searchInput" type="text" placeholder="Cari judul atau penulis..." class="input-field pl-10">
            </div>
            
            <select id="categorySelect" class="select-field">
              <option value="">Semua Kategori</option>
              <option value="Al-Qur'an">Al-Qur'an</option>
              <option value="Sirah">Sirah</option>
              <option value="Self Improvement">Pengembangan Diri</option>
              <option value="Ensiklopedia">Ensiklopedia</option>
              <option value="Wawasan">Pengetahuan Umum</option>
            </select>
            
            <select id="sortSelect" class="select-field">
              <option value="new">Terbaru</option>
              <option value="title">Judul A-Z</option>
              <option value="popular">Terpopuler</option>
            </select>
            
            <button id="clearFilter" class="px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 transition whitespace-nowrap">
              Reset Filter
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- BOOK COLLECTION -->
  <section id="koleksi" class="py-12 bg-gray-50">
    <div class="container mx-auto px-4 md:px-6">
      <div class="mb-8 text-center" data-aos="fade-up">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">Koleksi Buku Digital</h2>
        <p class="text-gray-600">Temukan berbagai buku menarik untuk memperluas wawasan Anda</p>
      </div>
      
      <div id="bookGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
        <!-- Books will be rendered here -->
      </div>
      
      <div id="loadingIndicator" class="hidden mt-12 flex justify-center">
        <div class="loading-spinner"></div>
      </div>
      
      <div id="emptyState" class="hidden mt-12 text-center">
        <i class="bi bi-book text-5xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-semibold text-gray-600 mb-2">Tidak ada buku yang ditemukan</h3>
        <p class="text-gray-500">Coba ubah filter pencarian Anda atau lihat kategori lainnya</p>
      </div>
    </div>
  </section>

  <!-- UPLOAD MODAL -->
  <div id="uploadModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl p-6 w-full max-w-md mx-4">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-semibold text-gray-800">Unggah Buku Baru</h3>
        <button id="closeModal" class="text-gray-400 hover:text-gray-600">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
      
      <p class="text-gray-600 mb-6">Buku yang diunggah akan melalui proses kurasi sebelum ditampilkan</p>
      
      <form id="uploadForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Judul Buku</label>
          <input type="text" class="input-field" placeholder="Masukkan judul buku" required>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Penulis</label>
          <input type="text" class="input-field" placeholder="Nama penulis" required>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
          <select class="select-field" required>
            <option value="">Pilih kategori</option>
            <option value="Al-Qur'an">Al-Qur'an</option>
            <option value="Sirah">Sirah</option>
            <option value="Self Improvement">Pengembangan Diri</option>
            <option value="Ensiklopedia">Ensiklopedia</option>
            <option value="Wawasan">Pengetahuan Umum</option>
          </select>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Unggah File PDF</label>
          <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
            <i class="bi bi-cloud-arrow-up text-3xl text-gray-400 mb-2"></i>
            <p class="text-sm text-gray-500">Drag & drop file PDF atau <span class="text-green-600 cursor-pointer">pilih file</span></p>
            <input type="file" accept=".pdf" class="hidden" required>
          </div>
        </div>
        
        <div class="pt-4">
          <button type="submit" class="btn-primary w-full">Ajukan untuk Dikurasi</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast">
    <i class="bi bi-check-circle-fill text-xl"></i>
    <span>Pesan berhasil dikirim!</span>
  </div>

  <!-- Footer -->
  <div id="footer"></div>

  <!-- Scripts -->
  <script src="../translate.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    // Initialize AOS
    document.addEventListener('DOMContentLoaded', function() {
      AOS.init({
        duration: 800,
        easing: 'ease-out',
        once: true,
        offset: 50
      });
    });

    // Toast function
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.querySelector('span').textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 4000);
    }

    /* =========================
       Mock auth gating Upload
    ==========================*/
    let isLoggedIn = false; // This would come from your auth system
    
    const uploadBtn = document.getElementById('uploadBtn');
    const uploadModal = document.getElementById('uploadModal');
    const closeModal = document.getElementById('closeModal');
    
    uploadBtn.addEventListener('click', () => {
      if (!isLoggedIn) {
        showToast('Silakan login terlebih dahulu untuk mengunggah buku');
      } else {
        uploadModal.classList.remove('hidden');
      }
    });
    
    closeModal.addEventListener('click', () => {
      uploadModal.classList.add('hidden');
    });
    
    // Close modal when clicking outside
    uploadModal.addEventListener('click', (e) => {
      if (e.target === uploadModal) {
        uploadModal.classList.add('hidden');
      }
    });
    
    // Handle form submission
    document.getElementById('uploadForm').addEventListener('submit', (e) => {
      e.preventDefault();
      showToast('Buku berhasil diajukan untuk dikurasi');
      uploadModal.classList.add('hidden');
    });

    /* =========================
       Book Data & Rendering
    ==========================*/
    const books = [
      {id:1, title:"Mushaf Madinah", author:"Tim LIPIA", category:"Al-Qur'an", cover:"https://picsum.photos/seed/quran/400/600", views: 125},
      {id:2, title:"Sirah Nabawiyah", author:"Shafiyyurrahman", category:"Sirah", cover:"https://picsum.photos/seed/sirah/400/600", views: 98},
      {id:3, title:"Atomic Habits", author:"James Clear", category:"Self Improvement", cover:"https://picsum.photos/seed/atomic/400/600", views: 203},
      {id:4, title:"Ensiklopedia Sains", author:"Tim Ensiklo", category:"Ensiklopedia", cover:"https://picsum.photos/seed/sains/400/600", views: 76},
      {id:5, title:"Geografi Global", author:"A. Kartono", category:"Wawasan", cover:"https://picsum.photos/seed/geo/400/600", views: 54},
      {id:6, title:"Mindset", author:"Carol Dweck", category:"Self Improvement", cover:"https://picsum.photos/seed/mind/400/600", views: 167},
      {id:7, title:"Publikasi Komunitas", author:"RB Labs", category:"Wawasan", cover:"https://picsum.photos/seed/kom/400/600", views: 42},
      {id:8, title:"Kamus Mini", author:"Tim KBBI", category:"Ensiklopedia", cover:"https://picsum.photos/seed/kamus/400/600", views: 89},
      {id:9, title:"Sirah Ringkas", author:"Ibn Hisyam", category:"Sirah", cover:"https://picsum.photos/seed/hisyam/400/600", views: 112},
      {id:10, title:"Kebiasaan 1%", author:"Anonim", category:"Self Improvement", cover:"https://picsum.photos/seed/one/400/600", views: 135},
    ];

    const bookGrid = document.getElementById('bookGrid');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const emptyState = document.getElementById('emptyState');
    
    function renderBookCard(book) {
      return `
        <div class="book-card card overflow-hidden group" data-aos="fade-up" data-category="${book.category}">
          <div class="relative overflow-hidden">
            <div class="aspect-[3/4] bg-gray-100 overflow-hidden">
              <img src="${book.cover}" alt="${book.title}" class="book-cover w-full h-full object-cover">
            </div>
            <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100">
              <div class="flex gap-2">
                <button class="bg-white rounded-full p-2 shadow-md hover:bg-green-50 transition" title="Baca Sekarang">
                  <i class="bi bi-play-fill text-green-600"></i>
                </button>
                <button class="bg-white rounded-full p-2 shadow-md hover:bg-green-50 transition" title="Simpan">
                  <i class="bi bi-bookmark text-green-600"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="p-4">
            <h3 class="font-semibold text-gray-800 mb-1 line-clamp-2" title="${book.title}">${book.title}</h3>
            <p class="text-sm text-gray-600 mb-2">${book.author}</p>
            <div class="flex justify-between items-center mt-3">
              <span class="category-badge">${book.category}</span>
              <span class="text-xs text-gray-500 flex items-center gap-1">
                <i class="bi bi-eye"></i> ${book.views}
              </span>
            </div>
          </div>
        </div>
      `;
    }
    
    function renderBooks(booksToRender) {
      if (booksToRender.length === 0) {
        bookGrid.classList.add('hidden');
        emptyState.classList.remove('hidden');
        return;
      }
      
      emptyState.classList.add('hidden');
      bookGrid.classList.remove('hidden');
      bookGrid.innerHTML = booksToRender.map(renderBookCard).join('');
    }
    
    // Initial render
    renderBooks(books);

    /* =========================
       Filter / Search / Sort
    ==========================*/
    const searchInput = document.getElementById('searchInput');
    const categorySelect = document.getElementById('categorySelect');
    const sortSelect = document.getElementById('sortSelect');
    const clearFilterBtn = document.getElementById('clearFilter');
    
    function applyFilters() {
      loadingIndicator.classList.remove('hidden');
      
      // Simulate loading
      setTimeout(() => {
        const searchTerm = searchInput.value.trim().toLowerCase();
        const category = categorySelect.value;
        const sortBy = sortSelect.value;
        
        let filteredBooks = books.filter(book => {
          const matchesSearch = !searchTerm || 
            book.title.toLowerCase().includes(searchTerm) || 
            book.author.toLowerCase().includes(searchTerm);
          
          const matchesCategory = !category || book.category === category;
          
          return matchesSearch && matchesCategory;
        });
        
        // Apply sorting
        if (sortBy === 'title') {
          filteredBooks.sort((a, b) => a.title.localeCompare(b.title));
        } else if (sortBy === 'popular') {
          filteredBooks.sort((a, b) => b.views - a.views);
        } else { // 'new' or default
          filteredBooks.sort((a, b) => b.id - a.id);
        }
        
        renderBooks(filteredBooks);
        loadingIndicator.classList.add('hidden');
      }, 500);
    }
    
    // Event listeners for filters
    searchInput.addEventListener('input', applyFilters);
    categorySelect.addEventListener('change', applyFilters);
    sortSelect.addEventListener('change', applyFilters);
    
    clearFilterBtn.addEventListener('click', () => {
      searchInput.value = '';
      categorySelect.value = '';
      sortSelect.value = 'new';
      applyFilters();
    });

    /* =========================
       Include Navbar & Footer
    ==========================*/
  async function loadComponent(id, file) {
    const res = await fetch(file);
    const html = await res.text();
    document.getElementById(id).innerHTML = html;

    // Trigger event bahwa navbar telah dimuat
    if (id === 'navbar') {
      document.dispatchEvent(new CustomEvent('navbarLoaded'));
    }

    // Jalankan ulang semua <script> di file yang di-load
    const scripts = document.getElementById(id).querySelectorAll("script");
    scripts.forEach(oldScript => {
      const newScript = document.createElement("script");
      if (oldScript.src) {
        newScript.src = oldScript.src;
        
        // Untuk auth.js, setup event listeners setelah selesai dimuat
        if (oldScript.src.includes('auth.js')) {
          newScript.onload = function() {
            console.log('Auth.js loaded, setting up navbar events...');
            
            // Setup events setelah auth.js selesai dimuat
            if (typeof setupNavbarEvents === 'function') {
              setupNavbarEvents();
            }
            if (typeof checkLoginStatus === 'function') {
              checkLoginStatus();
            }
          };
        }
      } else {
        // Untuk inline scripts, jalankan langsung
        newScript.textContent = oldScript.textContent;
      }
      document.body.appendChild(newScript);
    });
  }
  
  document.addEventListener("DOMContentLoaded", () => {
    loadComponent("navbar", "../navbar.html");
    loadComponent("footer", "../footer.html");
  });
  </script>
</body>
</html>